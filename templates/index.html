<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stay Fit</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="/static/styles.css">
	<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>
<body>
	<div class="top-bar">
		<div class="top-bar-container">
			<div class="logo">Stay Fit</div>
			<div class="login-button">
				<a href="/login" class="btn">Login</a>
			</div>
		</div>
	</div>

	<div class="hero" style="background-image: url('{{ url_for('static', filename='width_1024.png') }}');">
		<div class="hero-overlay">
			<h1 class="hero-title">Stay Fit</h1>
			<p class="hero-subtitle">Your Path to Better Physical Wellness Starts Here</p>
		</div>
	</div>

	<div class="info-section">
		<div class="info-container">
			<div class="info-image">
				<img src="{{ url_for('static', filename='width_640.png') }}" alt="Feeling Better Image">
			</div>
			<div class="info-text">
				<h2>Feeling better starts with moving better</h2>
				<p>At Stay Fit, we specialize in helping active individuals and athletes recover from injuries, regain strength, and return to peak performance. Our goal is to provide tailored exercise programs and expert guidance that support your recovery journey while enhancing your overall resilience and physical capabilities.</p>
			</div>
		</div>
	</div>
	
	<div class="message-section">
    <h1>User Experiences & Tips</h1>
		<form id="messageForm">
			<div class="form-row">
				<label for="msg_body_part">Body Part:</label>
				<select id="msg_body_part" name="msg_body_part">
					<option value="">--Select Body Part--</option>
					{% for part in body_parts %}
						<option value="{{ part }}">{{ part }}</option>
					{% endfor %}
				</select>

				<div class="slider-container">
					<label for="msg_severity">Severity:</label>
					<input type="range" id="msg_severity" name="msg_severity" min="1" max="3" value="1">
					<span id="msg-severity-label">Mild Pain</span>
				</div>
			</div>

			<textarea id="messageText" name="message" rows="4" placeholder="Share your experience or tips..." required></textarea>
			<button type="submit" class="btn">Submit Message</button>
		</form>

		<div id="messageResults">
			<h2>Messages:</h2>
			<ul id="messagesList"></ul>
		</div>
	</div>

    <div class="container">
        <h1>Injury-Specific Exercise Guide</h1>

        <form id="filterForm">
            <div class="form-row">
                <label for="body_part">Body Part:</label>
                <select id="body_part" name="body_part">
                    <option value="">--Select Body Part--</option>
                    {% for part in body_parts %}
                        <option value="{{ part }}">{{ part }}</option>
                    {% endfor %}
                </select>

                <div class="slider-container">
                    <label for="severity">Severity:</label>
                    <input type="range" id="severity" name="severity" min="1" max="3" value="1">
                    <span id="severity-label">Mild Pain</span>
                </div>
            </div>
        </form>

        <h2>Recommended Exercises:</h2>
        <ul id="exercisesList">
            <!-- Exercises will be dynamically populated here -->
        </ul>
    </div>

	<script>
		$(document).ready(function () {
			const severityLabels = ['Mild Pain', 'Moderate Injury', 'Major Injury'];

			$('#severity').on('input', function () {
				const severity = $(this).val();
				$('#severity-label').text(severityLabels[severity - 1]);
			});

			$('#filterForm select, #severity').change(function () {
				const bodyPart = $('#body_part').val();
				const severity = $('#severity').val();

				$.post('/get_exercises', { body_part: bodyPart, severity: severity }, function (data) {
					$('#exercisesList').empty();

					if (data.length > 0) {
						data.forEach(function (exercise) {
							$('#exercisesList').append(
								`<li>
									<strong>${exercise.exercise}</strong><br>
									<small><em>(${exercise.body_part} - ${exercise.severity})</em></small><br>
									${exercise.description}
								</li>`
							);
						});
					} else {
						$('#exercisesList').append('<li>No exercises found for the selected options.</li>');
					}
				});
			});

			// Message system logic
			$('#msg_severity').on('input', function () {
				$('#msg-severity-label').text(severityLabels[this.value - 1]);
				fetchMessages();
			});

			$('#msg_body_part').change(fetchMessages);

			function fetchMessages() {
				const part = $('#msg_body_part').val();
				const severity = $('#msg_severity').val();

				if (!part) {
					$('#messagesList').html('<li>Please select a body part.</li>');
					return;
				}

				$.post('/get_messages', { body_part: part, severity: severity }, function (messages) {
					$('#messagesList').empty();
					if (messages.length > 0) {
						messages.forEach(msg => {
							$('#messagesList').append(`<li>${msg}</li>`);
						});
					} else {
						$('#messagesList').append('<li>No messages yet. Be the first to share something!</li>');
					}
				});
			}

			$('#messageForm').submit(function (e) {
				e.preventDefault();
				const bodyPart = $('#msg_body_part').val();
				const severity = $('#msg_severity').val();
				const message = $('#messageText').val();

				$.post('/submit_message', {
					body_part: bodyPart,
					severity: severity,
					message: message
				}, function () {
					$('#messageText').val('');
					fetchMessages();
				});
			});
		});
	</script>
</body>
</html>
